<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>
        面对压迫、掠夺和孤单，我们的回答是生活
    </title>
    
<link rel="stylesheet" href="/libs/highlight/styles/monokai-sublime.css">

    
<link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">

    
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 4.2.0"></head>

<body id="bodyx">
    <div class="hd posts">
    <a href="/index.html"><i class="fa fa-reply replay-btn" aria-hidden="true"></i></a>
    <div class="post-title">
        <p>
            traceroute
        </p>
        <hr>
    </div>
    <div class="post-content">
        <p>traceroute 是用来检测发出数据包的主机到目标主机之间所经过的网关数量的工具。traceroute 的原理是试图以最小的TTL发出探测包来跟踪数据包到达目标主机所经过的网关，然后监听一个来自网关ICMP的应答。发送数据包的大小默认为 38个字节。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">tracert [-d] [-h maximum_hops] [-j computer-list] [-w timeout] target_name</span><br><span class="line"></span><br><span class="line">SYNOPSIS</span><br><span class="line"></span><br><span class="line">       traceroute [-46dFITUnreAV] [-f first_ttl] [-g gate,...]</span><br><span class="line"></span><br><span class="line">               [-i device] [-m max_ttl] [-p port] [-s src_addr]</span><br><span class="line"></span><br><span class="line">               [-q nqueries] [-N squeries] [-t tos]</span><br><span class="line"></span><br><span class="line">               [-l flow_label] [-w waittime] [-z sendwait]</span><br><span class="line"></span><br><span class="line">               [-UL] [-P proto] [--sport&#x3D;port] [-M method] [-O mod_options]</span><br><span class="line"></span><br><span class="line">               [--mtu] [--back]</span><br><span class="line"></span><br><span class="line">               host [packet_len]</span><br><span class="line"></span><br><span class="line">traceroute [参数选项] hostname，域名或 IP地址</span><br><span class="line"></span><br><span class="line">-i 指定网络接口，对于多个网络接口有用。比如 -i eth1 或-i ppp1等；</span><br><span class="line"></span><br><span class="line">-m 把在外发探测试包中所用的最大生存期设置为max-ttl次转发，默认值为30次；</span><br><span class="line"></span><br><span class="line">-n 显示IP地址，不查主机名。当DNS不起作用时常用到这个参数；</span><br><span class="line"></span><br><span class="line">-p port 探测包使用的基本UDP端口设置为port ，默认值是33434</span><br><span class="line"></span><br><span class="line">-q n 在每次设置生存期时，把探测包的个数设置为值n，默认时为3；</span><br><span class="line"></span><br><span class="line">-r 绕过正常的路由表，直接发送到网络相连的主机；</span><br><span class="line"></span><br><span class="line">-w n 把对外发探测包的等待响应时间设置为n秒，默认值为3秒；</span><br></pre></td></tr></table></figure>

<p>用法实例：</p>
<p>traceroute <a href="http://www.baidu.com" target="_blank" rel="noopener">www.baidu.com</a> </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">pc:~$ traceroute www.baidu.com</span><br><span class="line"></span><br><span class="line">traceroute: Warning:www.baidu.comhas multiple addresses; using 220.181.111.188</span><br><span class="line"></span><br><span class="line">traceroute towww.a.shifen.com(220.181.111.188), 64 hops max, 52 byte packets</span><br><span class="line"></span><br><span class="line">1  bogon (10.x.x.x)  0.968 ms  0.711 ms  0.710 ms</span><br><span class="line"></span><br><span class="line">2  bogon (172.x.x.x)  0.571 ms  0.545 ms  0.429 ms</span><br><span class="line"></span><br><span class="line">3129.x.x.x.broad.bj.bj.dynamic.163data.com.cn (219.x.x.x)  4.131 ms  3.252 ms  2.789 ms</span><br><span class="line"></span><br><span class="line">425.x.x.x.static.bjtelecom.net(106.x.x.x)  2.565 ms  2.067 ms  2.133 ms</span><br><span class="line"></span><br><span class="line">5  * * *</span><br><span class="line"></span><br><span class="line">6  36.x.x.x (36.x.x.x)  3.360 ms</span><br><span class="line"></span><br><span class="line">    219.x.x.x (219.x.x.x)  3.425 ms</span><br><span class="line"></span><br><span class="line">    36.x.x.x (36.x.x.x)  3.304 ms</span><br><span class="line"></span><br><span class="line">7  * * *</span><br><span class="line"></span><br><span class="line">8  220.x.x.x (220.x.x.x)  2.803 ms  4.935 ms</span><br><span class="line"></span><br><span class="line">    220.x.x.x (220.x.x.x)  3.736 ms</span><br><span class="line"></span><br><span class="line">9  * * *</span><br></pre></td></tr></table></figure>

<p>traceroute -m 10 <a href="http://www.baidu.com" target="_blank" rel="noopener">www.baidu.com</a>      设置跳数为10</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">pc:~ $ traceroute -m 10 www.baidu.com</span><br><span class="line"></span><br><span class="line">traceroute: Warning:www.baidu.comhas multiple addresses; using 220.181.111.188</span><br><span class="line"></span><br><span class="line">traceroute to www.a.shifen.com(220.181.111.188), 10 hops max, 52 byte packets</span><br><span class="line"></span><br><span class="line">1  bogon (10.x.x.x)  1.067 ms  4.024 ms  0.712 ms</span><br><span class="line"></span><br><span class="line">2  bogon (172.x.x.x)  0.309 ms  0.337 ms  0.607 ms</span><br><span class="line"></span><br><span class="line">3  129.x.x.x.broad.bj.bj.dynamic.163data.com.cn (219.x.x.x)  2.683 ms  3.353 ms  2.947 ms</span><br><span class="line"></span><br><span class="line">4  25.x.x.x.static.bjtelecom.net(x.x.x.25)  2.179 ms  2.325 ms  2.043 ms</span><br><span class="line"></span><br><span class="line">5  * * *</span><br><span class="line"></span><br><span class="line">6  36.x.x.x (36.x.x.x)  3.590 ms  7.793 ms  6.461 ms</span><br><span class="line"></span><br><span class="line">7  * * *</span><br><span class="line"></span><br><span class="line">8  220.x.x.x (220.x.x.x)  3.175 ms  2.893 ms</span><br><span class="line"></span><br><span class="line">    220.x.x.x (220.x.x.x)  5.538 ms</span><br><span class="line"></span><br><span class="line">9  * * *</span><br><span class="line"></span><br><span class="line">10  * * *</span><br></pre></td></tr></table></figure>

<p>traceroute -n <a href="http://www.baidu.com" target="_blank" rel="noopener">www.baidu.com</a>     只显示ip</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">pc:~ $ traceroute -n www.baidu.com</span><br><span class="line"></span><br><span class="line">traceroute: Warning:www.baidu.comhas multiple addresses; using 220.181.111.188</span><br><span class="line"></span><br><span class="line">traceroute to www.a.shifen.com(220.181.111.188), 64 hops max, 52 byte packets</span><br><span class="line"></span><br><span class="line">1  10.x.x.x  0.946 ms  0.761 ms  0.718 ms</span><br><span class="line"></span><br><span class="line">2  172.x.x.x  0.452 ms  0.338 ms  0.389 ms</span><br><span class="line"></span><br><span class="line">3  219.x.x.x  3.174 ms  4.038 ms  2.379 ms</span><br><span class="line"></span><br><span class="line">4  106.x.x.x  2.910 ms  1.960 ms  1.654 ms</span><br><span class="line"></span><br><span class="line">5  * * *</span><br><span class="line"></span><br><span class="line">6  36.x.x.x  3.321 ms  4.275 ms  3.637 ms</span><br></pre></td></tr></table></figure>

<p>traceroute -p 6888 <a href="http://www.baidu.com" target="_blank" rel="noopener">www.baidu.com</a>    设置探测包使用的基本UDP端口</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">pc:~ $ traceroute -p 6888 www.baidu.com</span><br><span class="line"></span><br><span class="line">traceroute: Warning:www.baidu.comhas multiple addresses; using 220.181.111.188</span><br><span class="line"></span><br><span class="line">traceroute to www.a.shifen.com(220.181.111.188), 64 hops max, 52 byte packets</span><br><span class="line"></span><br><span class="line">1  bogon (10.x.x.x)  0.989 ms  0.752 ms  0.722 ms</span><br><span class="line"></span><br><span class="line">2  bogon (172.x.x.x)  0.489 ms  0.399 ms  0.327 ms</span><br><span class="line"></span><br><span class="line">3  129.x.x.x.broad.bj.bj.dynamic.163data.com.cn (219.x.x.x)  3.094 ms  3.442 ms  3.529 ms</span><br><span class="line"></span><br><span class="line">4  25.x.x.x.static.bjtelecom.net(106.x.x.x)  1.837 ms  2.488 ms  2.516 ms</span><br><span class="line"></span><br><span class="line">5  * * *</span><br><span class="line"></span><br><span class="line">6  * 36.x.x.x (36.x.x.x)  4.876 ms</span><br></pre></td></tr></table></figure>

<p>traceroute -q 4 <a href="http://www.baidu.com" target="_blank" rel="noopener">www.baidu.com</a>   设置探测包的个数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">pc:~$ traceroute -q 4 www.baidu.com</span><br><span class="line"></span><br><span class="line">traceroute: Warning:www.baidu.comhas multiple addresses; using 220.181.111.188</span><br><span class="line"></span><br><span class="line">traceroute to www.a.shifen.com(220.181.111.188), 64 hops max, 52 byte packets</span><br><span class="line"></span><br><span class="line">1  bogon (10.x.x.x)  0.970 ms  0.721 ms  4.360 ms  0.667 ms</span><br><span class="line"></span><br><span class="line">2  bogon (172.x.x.x)  0.534 ms  0.640 ms  0.363 ms  0.449 ms</span><br><span class="line"></span><br><span class="line">3  129.x.x.x.broad.bj.bj.dynamic.163data.com.cn (x.x.x.129)  2.831 ms  3.221 ms  2.878 ms  2.814 ms</span><br><span class="line"></span><br><span class="line">4  25.x.x.x.static.bjtelecom.net(x.x.x.25)  1.921 ms  2.564 ms  2.472 ms  3.979 ms</span><br><span class="line"></span><br><span class="line">5  177.x.x.x.static.bjtelecom.net(x.x.x.177)  2.465 ms * * *</span><br><span class="line"></span><br><span class="line">6  219.x.x.x (219.x.x.x)  4.245 ms</span><br><span class="line"></span><br><span class="line">    36.x.x.x (36.x.x.x)  3.681 ms  3.053 ms</span><br><span class="line"></span><br><span class="line">    220.x.x.x (220.x.x.x)  3.444 ms</span><br></pre></td></tr></table></figure>

<p>traceroute -r <a href="http://www.baidu.com" target="_blank" rel="noopener">www.baidu.com</a>     绕过正常的路由表直接发送到网络相连的主机</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">pc:~ $ traceroute -r www.baidu.com</span><br><span class="line"></span><br><span class="line">traceroute: Warning:www.baidu.comhas multiple addresses; using 220.181.111.188</span><br><span class="line"></span><br><span class="line">traceroute to www.a.shifen.com(220.181.111.188), 64 hops max, 52 byte packets</span><br><span class="line"></span><br><span class="line">traceroute: sendto: Network is unreachable</span><br><span class="line"></span><br><span class="line">1 traceroute: wrotewww.a.shifen.com52 chars, ret&#x3D;-1</span><br><span class="line"></span><br><span class="line">*traceroute: sendto: Network is unreachable</span><br><span class="line"></span><br><span class="line">traceroute: wrotewww.a.shifen.com52 chars, ret&#x3D;-1</span><br><span class="line"></span><br><span class="line">*traceroute: sendto: Network is unreachable</span><br><span class="line"></span><br><span class="line">traceroute: wrotewww.a.shifen.com52 chars, ret&#x3D;-1</span><br><span class="line"></span><br><span class="line">*</span><br><span class="line"></span><br><span class="line">traceroute: sendto: Network is unreachable</span><br><span class="line"></span><br><span class="line">2 traceroute: wrotewww.a.shifen.com52 chars, ret&#x3D;-1</span><br><span class="line"></span><br><span class="line">traceroute -w 3 www.baidu.com       把对外发探测包的等待响应时间设置为n秒，默认值为3秒</span><br></pre></td></tr></table></figure>

<p>pc:~ $ traceroute -w 3<a href="http://www.baidu.com" target="_blank" rel="noopener">www.baidu.com</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">traceroute: Warning:www.baidu.comhas multiple addresses; using 220.181.111.188</span><br><span class="line"></span><br><span class="line">traceroute to www.a.shifen.com(220.181.111.188), 64 hops max, 52 byte packets</span><br><span class="line"></span><br><span class="line">1  bogon (10.x.x.x)  0.957 ms  0.710 ms  0.713 ms</span><br><span class="line"></span><br><span class="line">2  bogon (172.x.x.x)  0.603 ms  0.616 ms  0.321 ms</span><br><span class="line"></span><br><span class="line">3 129.x.x.x.broad.bj.bj.dynamic.163data.com.cn (x.x.x.129)  3.744 ms  2.371 ms  2.625 ms</span><br><span class="line"></span><br><span class="line">4 25.x.x.x.static.bjtelecom.net(x.x.x.25)  2.022 ms *  3.474 ms</span><br><span class="line"></span><br><span class="line">5  * * *</span><br><span class="line"></span><br><span class="line">6  36.x.x.x (36.x.x.x)  4.408 ms  5.760 ms  3.091 ms</span><br><span class="line"></span><br><span class="line">7  * * *</span><br><span class="line"></span><br><span class="line">8  220.x.x.x (220.x.x.x)  3.482 ms</span><br><span class="line"></span><br><span class="line">    220.x.x.x (220.x.x.x)  3.024 ms</span><br><span class="line"></span><br><span class="line">    220.x.x.x (220.x.x.x)  3.377 ms</span><br><span class="line"></span><br><span class="line">9  * *</span><br></pre></td></tr></table></figure>

<p>traceroute -i eth0 -4 <a href="http://www.baidu.com" target="_blank" rel="noopener">www.baidu.com</a> 使用eth0网口以及IPV4协议</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@ip-ops]# traceroute -i eth0 -4 www.baidu.com</span><br><span class="line"></span><br><span class="line">traceroute towww.baidu.com(220.181.112.244), 30 hops max, 60 byte packets</span><br><span class="line"></span><br><span class="line">1 compute.amazonaws.com.cn (54.x.x.x)  15.993 ms compute.amazonaws.com.cn (54.x.x.x)  11.778 ms.compute.amazonaws.com.cn (54.x.x.x)  12.896 ms</span><br><span class="line"></span><br><span class="line">2  100.x.x.x (100.x.x.x)  21.890 ms 100.x.x.x (100.x.x.x)  21.880 ms 100.x.x.x (100.x.x.x)  21.630 ms</span><br><span class="line"></span><br><span class="line">3  100.x.x.x (100.x.x.x)  12.609 ms 100.x.x.x (100.x.x.x)  22.017 ms 100.x.x.x(100.x.x.x)  14.010 ms</span><br><span class="line"></span><br><span class="line">4  100.x.x.x (100.x.x.x)  0.256 ms 100.x.x.x (100.x.x.x)  0.261 ms 100.x.x.x (100.x.x.x)  0.209 ms</span><br><span class="line"></span><br><span class="line">5  54.x.x.x (54.x.x.x)  1.071 ms 54.x.x.x (54.x.x.x)  1.536 ms  1.639 ms</span><br></pre></td></tr></table></figure>
    </div>

    
        <hr class="fhr">
        <div id="vcomments"></div>
    
</div>
    <div class="footer" id="footer">
    <p>Copyright © 2020 <a class="flink" href="https://hexo.io" target="_blank" rel="noopener">Hexo</a>-<a class="flink" href="https://github.com/sanjinhub/hexo-theme-geek" target="_blank" rel="noopener">Geek</a>.
        <label class="el-switch el-switch-green el-switch-sm" style="vertical-align: sub;">
            <input type="checkbox" name="switch" id="update_style">
            <span class="el-switch-style"></span>
        </label>
<!--         <script type="text/javascript">
        var cnzz_protocol = (("https:" == document.location.protocol) ? "https://" : "http://");
        document.write(unescape("%3Cspan id='cnzz_stat_icon_1278548644'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "v1.cnzz.com/stat.php%3Fid%3D1278548644%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));
        </script> -->
    </p>
</div>
<input type="hidden" id="web_style" value="black">
<input type="hidden" id="valine_appid" value="nmcd4VgylfORjevWz6UEoat3-9Nh9j0Va">
<input type="hidden" id="valine_appKey" value="wyWWI1qMf6w1mv1KpT1D0HeC">

<script src="/libs/jquery.min.js"></script>


<script src="/libs/highlight/highlight.pack.js"></script>

<script src='//cdn.jsdelivr.net/npm/valine@1.3.10/dist/Valine.min.js'></script>

<script src="/js/js.js"></script>

<style type="text/css">
.v * {
    color: #698fca;
}

.v .vlist .vcard .vhead .vsys {
    color: #3a3e4a;
}

.v .vlist .vcard .vh .vmeta .vat {
    color: #638fd5;
}

.v .vlist .vcard .vhead .vnick {
    color: #6ba1ff;
}

.v a {
    color: #8696b1;
}

.v .vlist .vcard .vhead .vnick:hover {
    color: #669bfc;
}
</style>
</body>

</html>
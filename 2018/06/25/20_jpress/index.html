<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>
        面对压迫、掠夺和孤单，我们的回答是生活
    </title>
    
<link rel="stylesheet" href="/libs/highlight/styles/monokai-sublime.css">

    
<link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">

    
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 4.2.0"></head>

<body id="bodyx">
    <div class="hd posts">
    <a href="/index.html"><i class="fa fa-reply replay-btn" aria-hidden="true"></i></a>
    <div class="post-title">
        <p>
            基于docker搭建个人博客jpress
        </p>
        <hr>
    </div>
    <div class="post-content">
        <p>####准备docker环境</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br></pre></td><td class="code"><pre><span class="line">[root@VM_0_45_centos ~]# yum install -y docker</span><br><span class="line">[root@VM_0_45_centos ~]# docker version</span><br><span class="line">Client:</span><br><span class="line"> Version:         1.13.1</span><br><span class="line"> API version:     1.26</span><br><span class="line"> Package version:</span><br><span class="line">Cannot connect to the Docker daemon at unix:&#x2F;&#x2F;&#x2F;var&#x2F;run&#x2F;docker.sock. Is the docker daemon running?</span><br><span class="line"></span><br><span class="line">[root@VM_0_45_centos ~]# service docker start</span><br><span class="line">Redirecting to &#x2F;bin&#x2F;systemctl start  docker.service</span><br><span class="line">[root@VM_0_45_centos ~]# docker version</span><br><span class="line">Client:</span><br><span class="line"> Version:         1.13.1</span><br><span class="line"> API version:     1.26</span><br><span class="line"> Package version: docker-1.13.1-63.git94f4240.el7.centos.x86_64</span><br><span class="line"> Go version:      go1.9.4</span><br><span class="line"> Git commit:      94f4240&#x2F;1.13.1</span><br><span class="line"> Built:           Fri May 18 15:44:33 2018</span><br><span class="line"> OS&#x2F;Arch:         linux&#x2F;amd64</span><br><span class="line"></span><br><span class="line">Server:</span><br><span class="line"> Version:         1.13.1</span><br><span class="line"> API version:     1.26 (minimum version 1.12)</span><br><span class="line"> Package version: docker-1.13.1-63.git94f4240.el7.centos.x86_64</span><br><span class="line"> Go version:      go1.9.4</span><br><span class="line"> Git commit:      94f4240&#x2F;1.13.1</span><br><span class="line"> Built:           Fri May 18 15:44:33 2018</span><br><span class="line"> OS&#x2F;Arch:         linux&#x2F;amd64</span><br><span class="line"> Experimental:    false</span><br><span class="line">可以看到docker的客户端和服务端都启动了</span><br><span class="line"></span><br><span class="line">---------------------------------------</span><br><span class="line">下载所需要的镜像  需要使用mysql和tomcat</span><br><span class="line">[root@VM_0_45_centos ~]# docker pull hub.c.163.com&#x2F;library&#x2F;mysql:latest</span><br><span class="line">Trying to pull repository hub.c.163.com&#x2F;library&#x2F;mysql ...</span><br><span class="line">latest: Pulling from hub.c.163.com&#x2F;library&#x2F;mysql</span><br><span class="line">42cb69312da9: Pull complete</span><br><span class="line">e2cf5467c4b5: Pull complete</span><br><span class="line">871ec0232f66: Pull complete</span><br><span class="line">3c0ae7ec690d: Pull complete</span><br><span class="line">d39b43089b70: Pull complete</span><br><span class="line">aa0e7cb4b67c: Pull complete</span><br><span class="line">738db9902d06: Pull complete</span><br><span class="line">ae333863ac05: Pull complete</span><br><span class="line">6d014992204a: Pull complete</span><br><span class="line">09aeca0c9a82: Pull complete</span><br><span class="line">0162083b2de0: Pull complete</span><br><span class="line">Digest: sha256:b2bce1a792237ac5df78877d583f34b09ab023a77130921a6bcce67ce2d24ff0</span><br><span class="line">Status: Downloaded newer image for hub.c.163.com&#x2F;library&#x2F;mysql:latest</span><br><span class="line"></span><br><span class="line">[root@VM_0_45_centos ~]# docker pull hub.c.163.com&#x2F;library&#x2F;tomcat:latest</span><br><span class="line">Trying to pull repository hub.c.163.com&#x2F;library&#x2F;tomcat ...</span><br><span class="line">latest: Pulling from hub.c.163.com&#x2F;library&#x2F;tomcat</span><br><span class="line">9af7279b9dbd: Pull complete</span><br><span class="line">31816c948f2f: Pull complete</span><br><span class="line">c59a1cdf83d3: Pull complete</span><br><span class="line">232c7a75d568: Pull complete</span><br><span class="line">de412d312979: Pull complete</span><br><span class="line">80315ba34693: Pull complete</span><br><span class="line">5d3f97bd90e8: Pull complete</span><br><span class="line">dc8dc63f6baa: Pull complete</span><br><span class="line">f6c6e2d67f03: Pull complete</span><br><span class="line">9123b340aa92: Pull complete</span><br><span class="line">76abaea2279d: Pull complete</span><br><span class="line">4476602e3346: Pull complete</span><br><span class="line">12e1fda011bd: Pull complete</span><br><span class="line">Digest: sha256:db1a8ca2fe44449d265e5505f300be6f34fc63211a5506400a0a8c24653af91f</span><br><span class="line">Status: Downloaded newer image for hub.c.163.com&#x2F;library&#x2F;tomcat:latest</span><br><span class="line"></span><br><span class="line">查看已下载的镜像</span><br><span class="line">[root@VM_0_45_centos ~]# docker images</span><br><span class="line">REPOSITORY                     TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line">hub.c.163.com&#x2F;library&#x2F;tomcat   latest              72d2be374029        10 months ago       292 MB</span><br><span class="line">hub.c.163.com&#x2F;library&#x2F;mysql    latest              9e64176cd8a2        14 months ago       407 MB</span><br><span class="line"></span><br><span class="line">jpress是一个开源项目 下载jpress war包</span><br><span class="line">[root@VM_0_45_centos ~]# wget https:&#x2F;&#x2F;gitee.com&#x2F;fuhai&#x2F;jpress&#x2F;raw&#x2F;alpha&#x2F;wars&#x2F;jpress-web-newest.war</span><br><span class="line">--2018-06-30 08:42:00--  https:&#x2F;&#x2F;gitee.com&#x2F;fuhai&#x2F;jpress&#x2F;raw&#x2F;alpha&#x2F;wars&#x2F;jpress-web-newest.war</span><br><span class="line">Resolving gitee.com (gitee.com)... 116.211.167.14</span><br><span class="line">Connecting to gitee.com (gitee.com)|116.211.167.14|:443... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: unspecified [text&#x2F;plain]</span><br><span class="line">Saving to: ‘jpress-web-newest.war’</span><br><span class="line"></span><br><span class="line">    [                                        &lt;&#x3D;&gt;      ] 20,797,013  2.57MB&#x2F;s   in 8.2s</span><br><span class="line"></span><br><span class="line">2018-06-30 08:42:09 (2.41 MB&#x2F;s) - ‘jpress-web-newest.war’ saved [20797013]</span><br><span class="line">[root@VM_0_45_centos ~]# ls</span><br><span class="line">jpress-web-newest.war</span><br><span class="line"></span><br><span class="line">----------------------------------------</span><br><span class="line">制作docker镜像</span><br><span class="line">[root@VM_0_45_centos ~]# mkdir jpress</span><br><span class="line">[root@VM_0_45_centos ~]# cd jpress&#x2F;</span><br><span class="line">[root@VM_0_45_centos jpress]# cp ..&#x2F;jpress-web-newest.war .&#x2F;jpress.war</span><br><span class="line">[root@VM_0_45_centos jpress]# vim Dockerfile</span><br><span class="line">[root@VM_0_45_centos jpress]# cat Dockerfile</span><br><span class="line">FROM hub.c.163.com&#x2F;library&#x2F;tomcat</span><br><span class="line"></span><br><span class="line">MAINTAINER zhaodan</span><br><span class="line"></span><br><span class="line">COPY jpress.war &#x2F;usr&#x2F;local&#x2F;tomcat&#x2F;webapps&#x2F;jpress.war</span><br><span class="line">##########</span><br><span class="line">FROM 表示：当前镜像依赖于tomcat镜像</span><br><span class="line"></span><br><span class="line">MAINTAINER 表示：镜像创建者</span><br><span class="line"></span><br><span class="line">COPY 表示：将jpress的war包复制到tomcat的webapps目录下</span><br><span class="line"></span><br><span class="line">[root@VM_0_37_centos study]# docker images</span><br><span class="line"></span><br><span class="line">REPOSITORY                     TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line"></span><br><span class="line">[hub.c.163.com&#x2F;library&#x2F;tomcat](http:&#x2F;&#x2F;hub.c.163.com&#x2F;library&#x2F;tomcat)   latest              72d2be374029        10 months ago       292 MB</span><br><span class="line"></span><br><span class="line">[hub.c.163.com&#x2F;library&#x2F;mysql](http:&#x2F;&#x2F;hub.c.163.com&#x2F;library&#x2F;mysql)    latest              9e64176cd8a2        13 months ago       407 MB</span><br><span class="line"></span><br><span class="line">构建jpress镜像 使用-t参数指定镜像名为my&#x2F;jpress tag为latest</span><br><span class="line"></span><br><span class="line">[root@VM_0_45_centos jpress]# docker build -t my&#x2F;jpress:latest .</span><br><span class="line">Sending build context to Docker daemon  41.6 MB</span><br><span class="line">Step 1&#x2F;3 : FROM hub.c.163.com&#x2F;library&#x2F;tomcat</span><br><span class="line"> ---&gt; 72d2be374029</span><br><span class="line">Step 2&#x2F;3 : MAINTAINER zhaodan</span><br><span class="line"> ---&gt; Running in d21d9ca26eac</span><br><span class="line"> ---&gt; f3143419a182</span><br><span class="line">Removing intermediate container d21d9ca26eac</span><br><span class="line">Step 3&#x2F;3 : COPY jpress.war &#x2F;usr&#x2F;local&#x2F;tomcat&#x2F;webapps&#x2F;jpress.war</span><br><span class="line"> ---&gt; 01a57cf0c2e1</span><br><span class="line">Removing intermediate container 5ed20c9d84e4</span><br><span class="line">Successfully built 01a57cf0c2e1</span><br><span class="line"></span><br><span class="line">[root@VM_0_45_centos jpress]# docker images</span><br><span class="line">REPOSITORY                     TAG                 IMAGE ID            CREATED              SIZE</span><br><span class="line">my&#x2F;jpress                      latest              01a57cf0c2e1        About a minute ago   313 MB</span><br><span class="line">hub.c.163.com&#x2F;library&#x2F;tomcat   latest              72d2be374029        10 months ago        292 MB</span><br><span class="line">hub.c.163.com&#x2F;library&#x2F;mysql    latest              9e64176cd8a2        14 months ago        407 MB</span><br><span class="line"></span><br><span class="line">启动docker镜像，先启动MySQL镜像，创建一个名为bolgdb的数据库，指定数据库用户以及登录密码，进行端口映射，启动数据库</span><br><span class="line">[root@VM_0_45_centos jpress]# docker run --name bolgmysql -d -p 3306:3306 -e MYSQL_ROOT_PASSWORD&#x3D;123456 -e MYSQL_DATABASE&#x3D;bolgdb hub.c.163.com&#x2F;library&#x2F;mysql</span><br><span class="line">901aa0b984ca137d04d5a90a9d08b133b38b4dd709e5dc08928b002222137b3f</span><br><span class="line"></span><br><span class="line">查看正在运行的容器</span><br><span class="line">[root@VM_0_45_centos jpress]# docker ps</span><br><span class="line">CONTAINER ID        IMAGE                         COMMAND                  CREATED             STATUS              PORTS                    NAMES</span><br><span class="line">901aa0b984ca        hub.c.163.com&#x2F;library&#x2F;mysql   &quot;docker-entrypoint...&quot;   44 seconds ago      Up 44 seconds       0.0.0.0:3306-&gt;3306&#x2F;tcp   bolgmysql</span><br><span class="line"></span><br><span class="line">[root@VM_0_45_centos jpress]# docker run --name bolgjpress -d -p 8888:8080 my&#x2F;jpress</span><br><span class="line">e8acfe19e3438f6a0b15ee25570c597cd901820ee916cb4310caa00b50bb1157</span><br><span class="line"></span><br><span class="line">[root@VM_0_45_centos jpress]# docker ps</span><br><span class="line">CONTAINER ID        IMAGE                         COMMAND                  CREATED             STATUS              PORTS                    NAMES</span><br><span class="line">e8acfe19e343        my&#x2F;jpress                     &quot;catalina.sh run&quot;        32 seconds ago      Up 31 seconds       0.0.0.0:8888-&gt;8080&#x2F;tcp   bolgjpress</span><br><span class="line">901aa0b984ca        hub.c.163.com&#x2F;library&#x2F;mysql   &quot;docker-entrypoint...&quot;   4 minutes ago       Up 4 minutes        0.0.0.0:3306-&gt;3306&#x2F;tcp   bolgmysql</span><br></pre></td></tr></table></figure>

<p>访问<br>ip + port   tomcat</p>
<p><a href="https://postimg.cc/tYdv1QgL" target="_blank" rel="noopener"><img src="https://i.postimg.cc/TYFz4TvY/jpress1.png" alt="jpress1.png"></a></p>
<p>ip + port/jpress</p>
<p><a href="https://postimg.cc/0b1H229Y" target="_blank" rel="noopener"><img src="https://i.postimg.cc/rFD6jKbP/jpress2.png" alt="jpress2.png"></a></p>
<p>第一次访问需要进行安装点，击下一步进行数据库配置，将启动mysql镜像时配置的数据库名称、端口、用户名和密码对应填写</p>
<p><a href="https://postimg.cc/hhd5B7R4" target="_blank" rel="noopener"><img src="https://i.postimg.cc/2jcRn4HW/jpress3.png" alt="jpress3.png"></a></p>
<p><a href="https://postimg.cc/V0nGB2W0" target="_blank" rel="noopener"><img src="https://i.postimg.cc/GtSWrCBK/jpress4.png" alt="jpress4.png"></a><br><a href="https://postimg.cc/yk0tF3Lp" target="_blank" rel="noopener"><img src="https://i.postimg.cc/024v1pDv/jpress5.png" alt="jpress5.png"></a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">重启jpress容器，使用命令docker ps查看正在运行的容器</span><br><span class="line">[root@VM_0_45_centos jpress]# docker ps</span><br><span class="line">CONTAINER ID        IMAGE                         COMMAND                  CREATED             STATUS              PORTS                    NAMES</span><br><span class="line">e8acfe19e343        my&#x2F;jpress                     &quot;catalina.sh run&quot;        13 minutes ago      Up 13 minutes       0.0.0.0:8888-&gt;8080&#x2F;tcp   bolgjpress</span><br><span class="line">901aa0b984ca        hub.c.163.com&#x2F;library&#x2F;mysql   &quot;docker-entrypoint...&quot;   17 minutes ago      Up 17 minutes       0.0.0.0:3306-&gt;3306&#x2F;tcp   bolgmysql</span><br><span class="line">[root@VM_0_45_centos jpress]# docker restart e8acfe19e343</span><br><span class="line">e8acfe19e343</span><br><span class="line"></span><br><span class="line">##########################</span><br><span class="line">docker常用命令</span><br><span class="line"></span><br><span class="line">docker stop 容器ID，停止容器</span><br><span class="line"></span><br><span class="line">docker restart 容器ID，重启容器</span><br><span class="line"></span><br><span class="line">docker start 容器ID，启动容器</span><br><span class="line"></span><br><span class="line">docker rm  容器ID，删除容器</span><br><span class="line">#########################</span><br></pre></td></tr></table></figure>
<p>刷新网页</p>
<p><a href="https://postimg.cc/vgp2nGfd" target="_blank" rel="noopener"><img src="https://i.postimg.cc/C5K3W1Kd/jpress6.png" alt="jpress6.png"></a><br> 登录后台</p>
<p><a href="https://postimg.cc/5X3rrddw" target="_blank" rel="noopener"><img src="https://i.postimg.cc/Gpw1HdXS/jpress7.png" alt="jpress7.png"></a><br><a href="https://postimg.cc/YvkV82Vr" target="_blank" rel="noopener"><img src="https://i.postimg.cc/cL8SxrBn/jpress8.png" alt="jpress8.png"></a></p>

    </div>

    
        <hr class="fhr">
        <div id="vcomments"></div>
    
</div>
    <div class="footer" id="footer">
    <p>Copyright © 2020 <a class="flink" href="https://hexo.io" target="_blank" rel="noopener">Hexo</a>-<a class="flink" href="https://github.com/sanjinhub/hexo-theme-geek" target="_blank" rel="noopener">Geek</a>.
        <label class="el-switch el-switch-green el-switch-sm" style="vertical-align: sub;">
            <input type="checkbox" name="switch" id="update_style">
            <span class="el-switch-style"></span>
        </label>
<!--         <script type="text/javascript">
        var cnzz_protocol = (("https:" == document.location.protocol) ? "https://" : "http://");
        document.write(unescape("%3Cspan id='cnzz_stat_icon_1278548644'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "v1.cnzz.com/stat.php%3Fid%3D1278548644%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));
        </script> -->
    </p>
</div>
<input type="hidden" id="web_style" value="black">
<input type="hidden" id="valine_appid" value="nmcd4VgylfORjevWz6UEoat3-9Nh9j0Va">
<input type="hidden" id="valine_appKey" value="wyWWI1qMf6w1mv1KpT1D0HeC">

<script src="/libs/jquery.min.js"></script>


<script src="/libs/highlight/highlight.pack.js"></script>

<script src='//cdn.jsdelivr.net/npm/valine@1.3.10/dist/Valine.min.js'></script>

<script src="/js/js.js"></script>

<style type="text/css">
.v * {
    color: #698fca;
}

.v .vlist .vcard .vhead .vsys {
    color: #3a3e4a;
}

.v .vlist .vcard .vh .vmeta .vat {
    color: #638fd5;
}

.v .vlist .vcard .vhead .vnick {
    color: #6ba1ff;
}

.v a {
    color: #8696b1;
}

.v .vlist .vcard .vhead .vnick:hover {
    color: #669bfc;
}
</style>
</body>

</html>